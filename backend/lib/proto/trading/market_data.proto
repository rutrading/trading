syntax = "proto3";

package trading;

service MarketDataService {
  rpc Fetch(FetchRequest) returns (FetchResponse);
  rpc BulkFetch(BulkFetchRequest) returns (BulkFetchResponse);
  rpc FetchHistoricalBars(HistoricalBarsRequest) returns (HistoricalBarsResponse);
}

message FetchRequest {
  string symbol = 1;
}

message FetchResponse {
  string symbol = 1;
  double price = 2;
  double open = 3;
  double high = 4;
  double low = 5;
  double volume = 6;
  int64 timestamp = 7;
  string source = 8;
  map<string, string> raw = 9;
}

message BulkFetchRequest {
  repeated string symbols = 1;
}

message BulkFetchResponse {
  repeated FetchResponse quotes = 1;
}

message HistoricalBarsRequest {
  string symbol = 1;
  string timeframe = 2;
  string start = 3;
  string end = 4;
}

message HistoricalBar {
  int64 timestamp = 1;
  double open = 2;
  double high = 3;
  double low = 4;
  double close = 5;
  double volume = 6;
  double vwap = 7;
  int64 trade_count = 8;
}

message HistoricalBarsResponse {
  string symbol = 1;
  string timeframe = 2;
  repeated HistoricalBar bars = 3;
  string source = 4;
}
